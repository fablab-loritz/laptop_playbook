#!/bin/bash

echo ""
echo "*****  Préparation Préliminaire  *****"
echo ""

apt-add-repository ppa:ansible/ansible -y
apt update
apt full-upgrade -y

apt install ansible git -y

echo ""
echo "*****  Provisionnement Initial  *****"
echo ""

# Exécution d'ansible
ansible-pull -U https://github.com/fablab-loritz/laptop_playbook.git
ANSIBLE_RC=$?

echo ""

if [ $ANSIBLE_RC -ne 0 ]; then
    echo "*****  ERREUR LORS DU PROVISIONNEMENT  *****"
    echo "*****   La commande ansible a échoué   *****"
    echo "*****   Code de retour : $ANSIBLE_RC   *****"
    echo ""
    exit $ANSIBLE_RC
else
    echo "*****       Provisionnement Terminé       *****"
    echo "***** Vous pouvez redémarrer l'ordinateur *****"
    echo ""
fi
